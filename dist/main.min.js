var Coframejs;(()=>{"use strict";var e={d:(n,t)=>{for(var a in t)e.o(t,a)&&!e.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:t[a]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{getVariants:()=>getVariants,measureBounce:()=>measureBounce,measureConversion:()=>measureConversion,measureEngagement:()=>measureEngagement,sendDataToBackend:()=>sendDataToBackend});const t=1e4;let a=null,o=!1,r=!1,s=!0,i=[];async function getVariants(e,n,t,a){return(await fetch("https://coframe.ai/api/v1/retrieve_variants_page/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({coframe_page_id:e,time:n,languages:void 0!==t?t.languages||t.language:void 0,platform:void 0!==t?t.platform||t.userAgentData&&t.userAgentData.platform:void 0,referrer:a})})).json()}async function sendDataToBackend(e){e.session_ids=i;try{return(await fetch("https://coframe.ai/api/v1/session_result/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}catch(e){console.error("Failed to send data:",e)}}function measureEngagement(){const e=new Date-a;e>=t?(o=!0,sendDataToBackend({engagement:!0})):setTimeout(measureEngagement,t-e)}function measureConversion(){r=!0,s=!1,sendDataToBackend({conversion:!0})}function measureBounce(){s&&sendDataToBackend({bounced:!0})}const c={};c.init=async function(){var e=window.COFRAME_PAGE_ID;a=new Date,window.addEventListener("beforeunload",measureBounce),document.addEventListener("visibilitychange",measureEngagement),document.addEventListener("conversion",measureConversion),setTimeout(measureEngagement,t);const n=await getVariants(e,a,navigator,document.referrer),o=n.variants;i=n.session_ids;try{o.forEach((({original:e,copy:n})=>{!function replaceText(e,n){const t=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1),a=new RegExp(e,"g");let o;for(;o=t.nextNode();)o.parentElement&&"script"!==o.parentElement.tagName.toLowerCase()&&(o.textContent=o.textContent.replace(a,n))}(e,n)}))}catch{}},c.logCoframeConversion=function(){document.dispatchEvent(new CustomEvent("conversion",{}))},window.Coframe=c,c.init(),Coframejs=n})();